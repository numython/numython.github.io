<html><body><div style="text-align: justify;">Las grillas o conjunto de celdas se utilizan para mostrar conjuntos de datos numéricos y/o cualquier otro tipo en una interfaz sencilla y muy similar a las tradicionales celdas de las hojas de cálculos.</div><div style="text-align: justify;"><br></div><div style="text-align: justify;">En wxPython para crear una grilla debemos importar el módulo <code style="white-space: pre;">wx.grid</code> y utilizar la clase <code style="white-space: pre;">Grid</code> de dicho módulo. Para inicializar/instanciar un objeto de la clase <code style="white-space: pre;">Grid</code> debemos pasarle como argumentos mínimos el objeto padre y un ID, y enseguida debemos definir el número de filas y columnas que compondrán la grilla utilizando el método <code style="white-space: pre;">CreateGrid</code>, tal cómo se observa en el siguiente ejemplo:</div><br><div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co" style="color: #60a0b0; font-style: italic;"># -*- coding: utf-8 -*-</span><br><span class="im">import</span> wx<br><span class="im">import</span> wx.grid <span class="im">as</span> wxgrid<br><br><span class="kw" style="color: #007020; font-weight: bold;">class</span> TestFrame(wx.Frame):<br>    <span class="kw" style="color: #007020; font-weight: bold;">def</span> <span class="fu" style="color: #06287e;">__init__</span>(<span class="va" style="color: #19177c;">self</span>,parent,title):<br>        wx.Frame.<span class="fu" style="color: #06287e;">__init__</span>(<span class="va" style="color: #19177c;">self</span>,parent<span class="op" style="color: #666666;">=</span>parent,title<span class="op" style="color: #666666;">=</span>title,size<span class="op" style="color: #666666;">=</span>(<span class="dv" style="color: #40a070;">250</span>,<span class="dv" style="color: #40a070;">250</span>))<br>        <br>        <span class="va" style="color: #19177c;">self</span>.grid <span class="op" style="color: #666666;">=</span> wxgrid.Grid(<span class="va" style="color: #19177c;">self</span>, <span class="op" style="color: #666666;">-</span><span class="dv" style="color: #40a070;">1</span>)<br>        <span class="va" style="color: #19177c;">self</span>.grid.CreateGrid(<span class="dv" style="color: #40a070;">10</span>,<span class="dv" style="color: #40a070;">2</span>)<br>        <br>        <span class="va" style="color: #19177c;">self</span>.Centre(<span class="va" style="color: #19177c;">True</span>)<br>        <span class="va" style="color: #19177c;">self</span>.Show()<br><br><span class="cf" style="color: #007020; font-weight: bold;">if</span> <span class="va" style="color: #19177c;">__name__</span><span class="op" style="color: #666666;">==</span><span class="st" style="color: #4070a0;">'__main__'</span>:<br>    app <span class="op" style="color: #666666;">=</span> wx.App()<br>    fr <span class="op" style="color: #666666;">=</span> TestFrame(<span class="va" style="color: #19177c;">None</span>, <span class="st" style="color: #4070a0;">"Test Grid"</span>)<br>    app.MainLoop()</code></pre></div><a href="file:///C:/Users/User/Desktop/LABPro/_blogs_/wxPython/Posts/Utilizando%20grillas%20de%20celdas%20en%20wxPython%20(wx.grid.Grid)/img/img_01.png"></a><br><div class="separator" style="clear: both; text-align: center;"><a href="https://3.bp.blogspot.com/-cwwDXrmxmqM/VsyJcCahecI/AAAAAAAABwM/VGZTNcZshW4/s1600/img_01.PNG" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="https://3.bp.blogspot.com/-cwwDXrmxmqM/VsyJcCahecI/AAAAAAAABwM/VGZTNcZshW4/s1600/img_01.PNG"></a></div><h3 id="insertando-valores"></h3><h3 id="insertando-valores">Insertando valores</h3><div style="text-align: justify;"><br></div><div style="text-align: justify;">Y ahora, ¿cómo insertamos valores en cada celda?. Para <em>rellenar</em> las celdas de una grilla utilizamos el método <code style="white-space: pre;">SetCellValue</code>, pasando como argumentos la posición fila-columna de la celda y un string con el valor a insertar. Algo como:</div><br><pre><code>self.grid.SetCellValue(fila,columna,valor)</code></pre><br><div style="text-align: justify;">Donde <code style="white-space: pre;">fila</code> y <code style="white-space: pre;">columna</code> son valores enteros que especifican la posición de la celda y <code style="white-space: pre;">valor</code> una cadena de caracteres. Veamos el siguiente ejemplo:</div><div style="text-align: justify;"><br></div><div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co" style="color: #60a0b0; font-style: italic;"># -*- coding: utf-8 -*-</span><br><span class="im">import</span> wx<br><span class="im">import</span> wx.grid <span class="im">as</span> wxgrid<br><br><span class="kw" style="color: #007020; font-weight: bold;">class</span> TestFrame(wx.Frame):<br>    <span class="kw" style="color: #007020; font-weight: bold;">def</span> <span class="fu" style="color: #06287e;">__init__</span>(<span class="va" style="color: #19177c;">self</span>,parent,title):<br>        wx.Frame.<span class="fu" style="color: #06287e;">__init__</span>(<span class="va" style="color: #19177c;">self</span>,parent<span class="op" style="color: #666666;">=</span>parent,title<span class="op" style="color: #666666;">=</span>title,size<span class="op" style="color: #666666;">=</span>(<span class="dv" style="color: #40a070;">250</span>,<span class="dv" style="color: #40a070;">250</span>))<br>        <br>        filas <span class="op" style="color: #666666;">=</span> <span class="dv" style="color: #40a070;">10</span><br>        columnas <span class="op" style="color: #666666;">=</span> <span class="dv" style="color: #40a070;">2</span><br>        <span class="va" style="color: #19177c;">self</span>.grid <span class="op" style="color: #666666;">=</span> wxgrid.Grid(<span class="va" style="color: #19177c;">self</span>, <span class="op" style="color: #666666;">-</span><span class="dv" style="color: #40a070;">1</span>)<br>        <span class="va" style="color: #19177c;">self</span>.grid.CreateGrid(filas,columnas)<br>        <br>        <span class="cf" style="color: #007020; font-weight: bold;">for</span> i <span class="op" style="color: #666666;">in</span> <span class="bu">range</span>(filas):<br>            <span class="cf" style="color: #007020; font-weight: bold;">for</span> j <span class="op" style="color: #666666;">in</span> <span class="bu">range</span>(columnas):<br>                valor <span class="op" style="color: #666666;">=</span> <span class="st" style="color: #4070a0;">"(</span><span class="sc" style="color: #4070a0;">%s</span><span class="st" style="color: #4070a0;">,</span><span class="sc" style="color: #4070a0;">%s</span><span class="st" style="color: #4070a0;">)"</span><span class="op" style="color: #666666;">%</span>(i,j)<br>                <span class="va" style="color: #19177c;">self</span>.grid.SetCellValue(i,j,valor)<br>        <br>        <span class="va" style="color: #19177c;">self</span>.Centre(<span class="va" style="color: #19177c;">True</span>)<br>        <span class="va" style="color: #19177c;">self</span>.Show()<br><br><span class="cf" style="color: #007020; font-weight: bold;">if</span> <span class="va" style="color: #19177c;">__name__</span><span class="op" style="color: #666666;">==</span><span class="st" style="color: #4070a0;">'__main__'</span>:<br>    app <span class="op" style="color: #666666;">=</span> wx.App()<br>    fr <span class="op" style="color: #666666;">=</span> TestFrame(<span class="va" style="color: #19177c;">None</span>, <span class="st" style="color: #4070a0;">"Test Grid"</span>)<br>    app.MainLoop()</code></pre></div><a href="file:///C:/Users/User/Desktop/LABPro/_blogs_/wxPython/Posts/Utilizando%20grillas%20de%20celdas%20en%20wxPython%20(wx.grid.Grid)/img/img_02.png"></a><br><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-UlfQS0upsFg/VsyJcHgwuZI/AAAAAAAABwU/0eCeRn6oeJA/s1600/img_02.PNG" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="https://2.bp.blogspot.com/-UlfQS0upsFg/VsyJcHgwuZI/AAAAAAAABwU/0eCeRn6oeJA/s1600/img_02.PNG"></a></div><h3 id="modificando-el-color-de-celdas">Modificando el color de celdas</h3><div style="text-align: justify;">Para modificar el color de una celda debemos utilizar el método <code style="white-space: pre;">SetCellBackgroundColour</code> al cual se le pasan como argumentos la posición de la celda y el color a usar (en forma de cadena hexadecimal o bien mediante la clase <code style="white-space: pre;">wx.Colour</code>). En el siguiente ejemplo se muestra como colorear las filas impares de un color determinado:</div><br><div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co" style="color: #60a0b0; font-style: italic;"># -*- coding: utf-8 -*-</span><br><span class="im">import</span> wx<br><span class="im">import</span> wx.grid <span class="im">as</span> wxgrid<br><br><span class="kw" style="color: #007020; font-weight: bold;">class</span> TestFrame(wx.Frame):<br>    <span class="kw" style="color: #007020; font-weight: bold;">def</span> <span class="fu" style="color: #06287e;">__init__</span>(<span class="va" style="color: #19177c;">self</span>,parent,title):<br>        wx.Frame.<span class="fu" style="color: #06287e;">__init__</span>(<span class="va" style="color: #19177c;">self</span>,parent<span class="op" style="color: #666666;">=</span>parent,title<span class="op" style="color: #666666;">=</span>title,size<span class="op" style="color: #666666;">=</span>(<span class="dv" style="color: #40a070;">250</span>,<span class="dv" style="color: #40a070;">250</span>))<br>        <br>        filas <span class="op" style="color: #666666;">=</span> <span class="dv" style="color: #40a070;">10</span><br>        columnas <span class="op" style="color: #666666;">=</span> <span class="dv" style="color: #40a070;">2</span><br>        <span class="va" style="color: #19177c;">self</span>.grid <span class="op" style="color: #666666;">=</span> wxgrid.Grid(<span class="va" style="color: #19177c;">self</span>, <span class="op" style="color: #666666;">-</span><span class="dv" style="color: #40a070;">1</span>)<br>        <span class="va" style="color: #19177c;">self</span>.grid.CreateGrid(filas,columnas)<br>        <br>        <span class="co" style="color: #60a0b0; font-style: italic;"># Asignando valores</span><br>        <span class="cf" style="color: #007020; font-weight: bold;">for</span> i <span class="op" style="color: #666666;">in</span> <span class="bu">range</span>(filas):<br>            <span class="cf" style="color: #007020; font-weight: bold;">for</span> j <span class="op" style="color: #666666;">in</span> <span class="bu">range</span>(columnas):<br>                valor <span class="op" style="color: #666666;">=</span> <span class="st" style="color: #4070a0;">"(</span><span class="sc" style="color: #4070a0;">%s</span><span class="st" style="color: #4070a0;">,</span><span class="sc" style="color: #4070a0;">%s</span><span class="st" style="color: #4070a0;">)"</span><span class="op" style="color: #666666;">%</span>(i,j)<br>                <span class="va" style="color: #19177c;">self</span>.grid.SetCellValue(i,j,valor)<br>        <br>        <span class="co" style="color: #60a0b0; font-style: italic;"># Modificando el color de fondo</span><br>        <span class="cf" style="color: #007020; font-weight: bold;">for</span> ii <span class="op" style="color: #666666;">in</span> <span class="bu">range</span>(<span class="dv" style="color: #40a070;">0</span>,filas,<span class="dv" style="color: #40a070;">2</span>):<br>            <span class="cf" style="color: #007020; font-weight: bold;">for</span> jj <span class="op" style="color: #666666;">in</span> <span class="bu">range</span>(columnas):<br>                <span class="va" style="color: #19177c;">self</span>.grid.SetCellBackgroundColour(ii,jj,<span class="st" style="color: #4070a0;">"#fafa77"</span>)<br>        <br>        <span class="va" style="color: #19177c;">self</span>.Centre(<span class="va" style="color: #19177c;">True</span>)<br>        <span class="va" style="color: #19177c;">self</span>.Show()<br><br><span class="cf" style="color: #007020; font-weight: bold;">if</span> <span class="va" style="color: #19177c;">__name__</span><span class="op" style="color: #666666;">==</span><span class="st" style="color: #4070a0;">'__main__'</span>:<br>    app <span class="op" style="color: #666666;">=</span> wx.App()<br>    fr <span class="op" style="color: #666666;">=</span> TestFrame(<span class="va" style="color: #19177c;">None</span>, <span class="st" style="color: #4070a0;">"Test Grid"</span>)<br>    app.MainLoop()</code></pre></div><a href="file:///C:/Users/User/Desktop/LABPro/_blogs_/wxPython/Posts/Utilizando%20grillas%20de%20celdas%20en%20wxPython%20(wx.grid.Grid)/img/img_03.png"></a><br><div style="text-align: justify;"><br></div><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-W4JTmMutuB0/VsyJcNM4oxI/AAAAAAAABwQ/XNZJ1MP5TLw/s1600/img_03.PNG" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="https://1.bp.blogspot.com/-W4JTmMutuB0/VsyJcNM4oxI/AAAAAAAABwQ/XNZJ1MP5TLw/s1600/img_03.PNG"></a></div><div style="text-align: justify;"><br></div><div style="text-align: justify;"><br></div><div style="text-align: justify;">Para quitar las etiquetas de filas, que a veces pueden resultar poco convenientes, puede utilizar el método <code style="white-space: pre;">SetRowLabelSize</code> y pasar 0 (cero) como argumento.</div><div style="text-align: justify;"><br></div><div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="va" style="color: #19177c;">self</span>.grid.SetRowLabelSize(<span class="dv" style="color: #40a070;">0</span>)</code></pre></div><h3 id="personalizando-encabezados-y-anchos-de-columnas"></h3><h3 id="personalizando-encabezados-y-anchos-de-columnas">Personalizando encabezados y anchos de columnas</h3><div style="text-align: justify;"><br></div><div style="text-align: justify;">Los encabezados (<em>headers</em>) de columnas por defecto están rotulados como en una hoja de cálculo (letras en orden alfabético), pero pueden personalizarse utilizando el método <code style="white-space: pre;">SetColLabelValue</code>. Además también puede modificarse el ancho por defecto que tienen las columnas mediante el método <code style="white-space: pre;">SetColSize</code>. En el siguiente ejemplo se muestra lo mencionado anteriormente:</div><br><div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co" style="color: #60a0b0; font-style: italic;"># -*- coding: utf-8 -*-</span><br><span class="im">import</span> wx<br><span class="im">import</span> wx.grid <span class="im">as</span> wxgrid<br><span class="im">from</span> random <span class="im">import</span> randint<br><br><span class="kw" style="color: #007020; font-weight: bold;">class</span> TestFrame(wx.Frame):<br>    <span class="kw" style="color: #007020; font-weight: bold;">def</span> <span class="fu" style="color: #06287e;">__init__</span>(<span class="va" style="color: #19177c;">self</span>,parent,title):<br>        wx.Frame.<span class="fu" style="color: #06287e;">__init__</span>(<span class="va" style="color: #19177c;">self</span>,parent<span class="op" style="color: #666666;">=</span>parent,title<span class="op" style="color: #666666;">=</span>title,size<span class="op" style="color: #666666;">=</span>(<span class="dv" style="color: #40a070;">250</span>,<span class="dv" style="color: #40a070;">250</span>))<br>        <br>        filas <span class="op" style="color: #666666;">=</span> <span class="dv" style="color: #40a070;">10</span><br>        columnas <span class="op" style="color: #666666;">=</span> <span class="dv" style="color: #40a070;">2</span><br>        <span class="va" style="color: #19177c;">self</span>.grid <span class="op" style="color: #666666;">=</span> wxgrid.Grid(<span class="va" style="color: #19177c;">self</span>, <span class="op" style="color: #666666;">-</span><span class="dv" style="color: #40a070;">1</span>)<br>        <span class="va" style="color: #19177c;">self</span>.grid.CreateGrid(filas,columnas)<br>        <span class="va" style="color: #19177c;">self</span>.grid.SetRowLabelSize(<span class="dv" style="color: #40a070;">0</span>)<br>        <br>        <span class="co" style="color: #60a0b0; font-style: italic;"># Asignando valores aleatorios</span><br>        <span class="cf" style="color: #007020; font-weight: bold;">for</span> i <span class="op" style="color: #666666;">in</span> <span class="bu">range</span>(filas):<br>            <span class="cf" style="color: #007020; font-weight: bold;">for</span> j <span class="op" style="color: #666666;">in</span> <span class="bu">range</span>(columnas):<br>                valor <span class="op" style="color: #666666;">=</span> <span class="st" style="color: #4070a0;">"</span><span class="sc" style="color: #4070a0;">%g</span><span class="st" style="color: #4070a0;">"</span><span class="op" style="color: #666666;">%</span>(randint(<span class="dv" style="color: #40a070;">1</span>,<span class="dv" style="color: #40a070;">100</span>))<br>                <span class="va" style="color: #19177c;">self</span>.grid.SetCellValue(i,j,valor)<br>        <br>        <span class="co" style="color: #60a0b0; font-style: italic;"># Modificando el color de fondo</span><br>        <span class="cf" style="color: #007020; font-weight: bold;">for</span> ii <span class="op" style="color: #666666;">in</span> <span class="bu">range</span>(<span class="dv" style="color: #40a070;">0</span>,filas,<span class="dv" style="color: #40a070;">2</span>):<br>            <span class="cf" style="color: #007020; font-weight: bold;">for</span> jj <span class="op" style="color: #666666;">in</span> <span class="bu">range</span>(columnas):<br>                <span class="va" style="color: #19177c;">self</span>.grid.SetCellBackgroundColour(ii,jj,<span class="st" style="color: #4070a0;">"#fafa77"</span>)<br>        <br>        <span class="co" style="color: #60a0b0; font-style: italic;"># Modificando los encabezados y anchos de columna</span><br>        encabezados <span class="op" style="color: #666666;">=</span> [<span class="st" style="color: #4070a0;">"Tiempo (s)"</span>, <span class="st" style="color: #4070a0;">"Amplitud (mm)"</span>]<br>        anchos <span class="op" style="color: #666666;">=</span> [<span class="dv" style="color: #40a070;">100</span>, <span class="dv" style="color: #40a070;">100</span>]<br>        <span class="cf" style="color: #007020; font-weight: bold;">for</span> n,col <span class="op" style="color: #666666;">in</span> <span class="bu">enumerate</span>(<span class="bu">range</span>(columnas)):<br>            <span class="va" style="color: #19177c;">self</span>.grid.SetColLabelValue(col,encabezados[n])<br>            <span class="va" style="color: #19177c;">self</span>.grid.SetColSize(col,anchos[n])<br>        <br>        <span class="va" style="color: #19177c;">self</span>.Centre(<span class="va" style="color: #19177c;">True</span>)<br>        <span class="va" style="color: #19177c;">self</span>.Show()<br><br><span class="cf" style="color: #007020; font-weight: bold;">if</span> <span class="va" style="color: #19177c;">__name__</span><span class="op" style="color: #666666;">==</span><span class="st" style="color: #4070a0;">'__main__'</span>:<br>    app <span class="op" style="color: #666666;">=</span> wx.App()<br>    fr <span class="op" style="color: #666666;">=</span> TestFrame(<span class="va" style="color: #19177c;">None</span>, <span class="st" style="color: #4070a0;">"Test Grid"</span>)<br>    app.MainLoop()</code></pre></div><a href="file:///C:/Users/User/Desktop/LABPro/_blogs_/wxPython/Posts/Utilizando%20grillas%20de%20celdas%20en%20wxPython%20(wx.grid.Grid)/img/img_04.png"></a><br><br><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-Non89NEhu4M/VsyJc6xweCI/AAAAAAAABwY/wjRtyn3SpAk/s1600/img_04.PNG" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="https://1.bp.blogspot.com/-Non89NEhu4M/VsyJc6xweCI/AAAAAAAABwY/wjRtyn3SpAk/s1600/img_04.PNG"></a></div><br><br><div style="text-align: justify;">Y bueno, hasta aquí esta entrada introductoria al uso de grillas en wxPython, ya estaremos viendo posteriormente características más avanzadas que permitan personalizar mejor una grilla.</div><div style="text-align: justify;"><br></div><div style="text-align: justify;"><br></div><h3 id="y-una-mini-aplicación">Y una mini-aplicación</h3><div style="text-align: justify;"><br></div><div style="text-align: justify;">A continuación se adjunta una mini-aplicación en la cual se utiliza un grilla de 2x2 para emular los elementos de una matriz de 2x2, de la cual habrá de calcularse el determinante. Esta mini-aplicación incluye algunas consideraciones básicas sobre eventos en la grilla que posiblemente resulten de utilidad para el lector:</div><div style="text-align: justify;"><br></div><div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co" style="color: #60a0b0; font-style: italic;"># -*- coding: utf-8 -*-</span><br><span class="im">import</span> wx<br><span class="im">import</span> wx.grid <span class="im">as</span> wxgrid<br><br><span class="kw" style="color: #007020; font-weight: bold;">class</span> TestFrame(wx.Frame):<br>    <span class="kw" style="color: #007020; font-weight: bold;">def</span> <span class="fu" style="color: #06287e;">__init__</span>(<span class="va" style="color: #19177c;">self</span>,parent,title):<br>        wx.Frame.<span class="fu" style="color: #06287e;">__init__</span>(<span class="va" style="color: #19177c;">self</span>,parent<span class="op" style="color: #666666;">=</span>parent,title<span class="op" style="color: #666666;">=</span>title,size<span class="op" style="color: #666666;">=</span>(<span class="dv" style="color: #40a070;">200</span>,<span class="dv" style="color: #40a070;">200</span>))<br>        <span class="va" style="color: #19177c;">self</span>.panel <span class="op" style="color: #666666;">=</span> wx.Panel(<span class="va" style="color: #19177c;">self</span>, <span class="op" style="color: #666666;">-</span><span class="dv" style="color: #40a070;">1</span>)<br>        <span class="va" style="color: #19177c;">self</span>.sz <span class="op" style="color: #666666;">=</span> wx.BoxSizer(wx.VERTICAL)<br>        <br>        <span class="co" style="color: #60a0b0; font-style: italic;"># Grilla</span><br>        filas <span class="op" style="color: #666666;">=</span> <span class="dv" style="color: #40a070;">2</span><br>        columnas <span class="op" style="color: #666666;">=</span> <span class="dv" style="color: #40a070;">2</span><br>        <span class="va" style="color: #19177c;">self</span>.grid <span class="op" style="color: #666666;">=</span> wxgrid.Grid(<span class="va" style="color: #19177c;">self</span>.panel, <span class="op" style="color: #666666;">-</span><span class="dv" style="color: #40a070;">1</span>)<br>        <span class="va" style="color: #19177c;">self</span>.grid.CreateGrid(filas,columnas)<br>        <span class="va" style="color: #19177c;">self</span>.grid.SetRowLabelSize(<span class="dv" style="color: #40a070;">60</span>)<br>        <span class="cf" style="color: #007020; font-weight: bold;">for</span> col <span class="op" style="color: #666666;">in</span> <span class="bu">range</span>(columnas):<br>            <span class="va" style="color: #19177c;">self</span>.grid.SetColSize(col, <span class="dv" style="color: #40a070;">60</span>)<br>            <span class="va" style="color: #19177c;">self</span>.grid.SetColLabelValue(col, <span class="st" style="color: #4070a0;">"</span><span class="sc" style="color: #4070a0;">%s</span><span class="st" style="color: #4070a0;">"</span><span class="op" style="color: #666666;">%</span>(col<span class="dv" style="color: #40a070;">+1</span>))<br>        <br>        <span class="co" style="color: #60a0b0; font-style: italic;"># Campo de texto para resultados</span><br>        <span class="va" style="color: #19177c;">self</span>.res <span class="op" style="color: #666666;">=</span> wx.TextCtrl(<span class="va" style="color: #19177c;">self</span>.panel, <span class="op" style="color: #666666;">-</span><span class="dv" style="color: #40a070;">1</span>, <span class="st" style="color: #4070a0;">u""</span>, style<span class="op" style="color: #666666;">=</span>wx.TE_CENTRE)<br>        <br>        <span class="co" style="color: #60a0b0; font-style: italic;"># Botón para calcular</span><br>        <span class="va" style="color: #19177c;">self</span>.bt <span class="op" style="color: #666666;">=</span> wx.Button(<span class="va" style="color: #19177c;">self</span>.panel, <span class="op" style="color: #666666;">-</span><span class="dv" style="color: #40a070;">1</span>, <span class="st" style="color: #4070a0;">u"Calcular"</span>)<br>        <br>        <span class="co" style="color: #60a0b0; font-style: italic;"># Agregando elementos al sizer</span><br>        <span class="va" style="color: #19177c;">self</span>.sz.Add(<span class="va" style="color: #19177c;">self</span>.grid, <span class="dv" style="color: #40a070;">5</span>, wx.EXPAND<span class="op" style="color: #666666;">|</span>wx.ALL, <span class="dv" style="color: #40a070;">2</span>)<br>        <span class="va" style="color: #19177c;">self</span>.sz.Add(<span class="va" style="color: #19177c;">self</span>.res, <span class="dv" style="color: #40a070;">1</span>, wx.EXPAND<span class="op" style="color: #666666;">|</span>wx.ALL, <span class="dv" style="color: #40a070;">2</span>)<br>        <span class="va" style="color: #19177c;">self</span>.sz.Add(<span class="va" style="color: #19177c;">self</span>.bt, <span class="dv" style="color: #40a070;">1</span>, wx.ALIGN_CENTRE<span class="op" style="color: #666666;">|</span>wx.ALL, <span class="dv" style="color: #40a070;">2</span>)<br>        <br>        <span class="co" style="color: #60a0b0; font-style: italic;"># Conectando eventos </span><br>        <span class="va" style="color: #19177c;">self</span>.Bind(wx.EVT_BUTTON, <span class="va" style="color: #19177c;">self</span>.OnCalc, <span class="va" style="color: #19177c;">self</span>.bt)<br>        <span class="va" style="color: #19177c;">self</span>.Bind(wxgrid.EVT_GRID_CELL_CHANGED, <span class="va" style="color: #19177c;">self</span>.OnCellEdit)<br>        <br>        <span class="va" style="color: #19177c;">self</span>.panel.SetSizer(<span class="va" style="color: #19177c;">self</span>.sz)<br>        <span class="va" style="color: #19177c;">self</span>.Centre(<span class="va" style="color: #19177c;">True</span>)<br>        <span class="va" style="color: #19177c;">self</span>.Show()<br>        <br>    <span class="kw" style="color: #007020; font-weight: bold;">def</span> OnCalc(<span class="va" style="color: #19177c;">self</span>,event):<br>        <span class="co" style="color: #60a0b0; font-style: italic;">"""</span><br><span class="co" style="color: #60a0b0; font-style: italic;">        Ejecuta el cálculo del determinante, utilizando </span><br><span class="co" style="color: #60a0b0; font-style: italic;">        como punto de entrada la matriz obtenida mediante </span><br><span class="co" style="color: #60a0b0; font-style: italic;">        el método GetMatrix. El resultado obtenido se </span><br><span class="co" style="color: #60a0b0; font-style: italic;">        muestra en el TextCtrl destinado para tal uso.</span><br><span class="co" style="color: #60a0b0; font-style: italic;">        """</span><br>        M <span class="op" style="color: #666666;">=</span> <span class="va" style="color: #19177c;">self</span>.GetMatrix()<br>        <span class="cf" style="color: #007020; font-weight: bold;">if</span> M <span class="op" style="color: #666666;">is</span> <span class="va" style="color: #19177c;">None</span>:<br>            wx.MessageBox(<span class="st" style="color: #4070a0;">"Rellene todas las celdas..."</span>)<br>            <span class="cf" style="color: #007020; font-weight: bold;">return</span> <span class="va" style="color: #19177c;">None</span><br>        det <span class="op" style="color: #666666;">=</span> (M[<span class="dv" style="color: #40a070;">0</span>][<span class="dv" style="color: #40a070;">0</span>]<span class="op" style="color: #666666;">*</span>M[<span class="dv" style="color: #40a070;">1</span>][<span class="dv" style="color: #40a070;">1</span>]) <span class="op" style="color: #666666;">-</span> (M[<span class="dv" style="color: #40a070;">0</span>][<span class="dv" style="color: #40a070;">1</span>]<span class="op" style="color: #666666;">*</span>M[<span class="dv" style="color: #40a070;">1</span>][<span class="dv" style="color: #40a070;">0</span>])<br>        res <span class="op" style="color: #666666;">=</span> <span class="st" style="color: #4070a0;">"det(M) = </span><span class="sc" style="color: #4070a0;">%s</span><span class="st" style="color: #4070a0;">"</span><span class="op" style="color: #666666;">%</span>(det)<br>        <span class="va" style="color: #19177c;">self</span>.res.SetValue(res)<br>        <br>    <span class="kw" style="color: #007020; font-weight: bold;">def</span> GetMatrix(<span class="va" style="color: #19177c;">self</span>):<br>        <span class="co" style="color: #60a0b0; font-style: italic;">"""</span><br><span class="co" style="color: #60a0b0; font-style: italic;">        Construye una lista de listas para </span><br><span class="co" style="color: #60a0b0; font-style: italic;">        representar una matriz de 2x2.</span><br><span class="co" style="color: #60a0b0; font-style: italic;">        """</span><br>        rows <span class="op" style="color: #666666;">=</span> <span class="va" style="color: #19177c;">self</span>.grid.GetNumberRows()<br>        cols <span class="op" style="color: #666666;">=</span> <span class="va" style="color: #19177c;">self</span>.grid.GetNumberCols()<br>        M <span class="op" style="color: #666666;">=</span> []<br>        <span class="cf" style="color: #007020; font-weight: bold;">for</span> row <span class="op" style="color: #666666;">in</span> <span class="bu">range</span>(rows):<br>            _crow <span class="op" style="color: #666666;">=</span> []<br>            <span class="cf" style="color: #007020; font-weight: bold;">for</span> col <span class="op" style="color: #666666;">in</span> <span class="bu">range</span>(cols):<br>                cval <span class="op" style="color: #666666;">=</span> <span class="va" style="color: #19177c;">self</span>.grid.GetCellValue(row,col)<br>                <span class="cf" style="color: #007020; font-weight: bold;">if</span> <span class="op" style="color: #666666;">not</span> cval:<br>                    <span class="cf" style="color: #007020; font-weight: bold;">return</span> <span class="va" style="color: #19177c;">None</span><br>                _crow.append(<span class="bu">float</span>(cval))<br>            M.append(_crow)<br>        <span class="cf" style="color: #007020; font-weight: bold;">return</span> M<br>        <br>    <span class="kw" style="color: #007020; font-weight: bold;">def</span> OnCellEdit(<span class="va" style="color: #19177c;">self</span>,event):<br>        <span class="co" style="color: #60a0b0; font-style: italic;">"""</span><br><span class="co" style="color: #60a0b0; font-style: italic;">        Verifica que el valor introducido en una </span><br><span class="co" style="color: #60a0b0; font-style: italic;">        celda sea un número, de lo contrario elimina el valor.</span><br><span class="co" style="color: #60a0b0; font-style: italic;">        """</span><br>        ii,jj <span class="op" style="color: #666666;">=</span> event.GetRow(), event.GetCol()<br>        inval <span class="op" style="color: #666666;">=</span> <span class="va" style="color: #19177c;">self</span>.grid.GetCellValue(ii,jj)<br>        <span class="cf" style="color: #007020; font-weight: bold;">try</span>:<br>            cnum <span class="op" style="color: #666666;">=</span> <span class="bu">float</span>(inval)<br>        <span class="cf" style="color: #007020; font-weight: bold;">except</span>:<br>            <span class="va" style="color: #19177c;">self</span>.grid.SetCellValue(ii,jj,<span class="st" style="color: #4070a0;">""</span>)<br>        <br><br><span class="cf" style="color: #007020; font-weight: bold;">if</span> <span class="va" style="color: #19177c;">__name__</span><span class="op" style="color: #666666;">==</span><span class="st" style="color: #4070a0;">'__main__'</span>:<br>    app <span class="op" style="color: #666666;">=</span> wx.App()<br>    fr <span class="op" style="color: #666666;">=</span> TestFrame(<span class="va" style="color: #19177c;">None</span>, <span class="st" style="color: #4070a0;">"Determinante"</span>)<br>    app.MainLoop()</code></pre></div><br><div class="separator" style="clear: both; text-align: center;"><a href="https://3.bp.blogspot.com/-He5Yf0aq9V8/VsyJc6IKNDI/AAAAAAAABwc/4elHvRPDtYQ/s1600/img_05.PNG" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="https://3.bp.blogspot.com/-He5Yf0aq9V8/VsyJc6IKNDI/AAAAAAAABwc/4elHvRPDtYQ/s1600/img_05.PNG"></a></div><br></body></html>